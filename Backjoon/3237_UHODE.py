# êµ¬í˜„
# ìë£Œ êµ¬ì¡°
# ì‹œë®¬ë ˆì´ì…˜
# ì§‘í•©ê³¼ ë§µ
# í•´ì‹œë¥¼ ì‚¬ìš©í•œ ì§‘í•©ê³¼ ë§µ


# ë¬¸ì œ: https://www.acmicpc.net/problem/3237
# ë©”ëª¨ë¦¬: 35000KB / ì‹œê°„: 160ms
from sys import stdin


input = stdin.readline

def main():
    N = int(input())
    # spies[(x, y)]: (x, y)ì¢Œí‘œì— ìœ„ì¹˜í•œ ìŠ¤íŒŒì´ì˜ ë²ˆí˜¸
    # -> ğŸš¨ 3%ì—ì„œ ìê¾¸ í„°ì§€ê¸¸ë˜ ì°¾ì•„ë³´ë‹ˆ, ìŠ¤íŒŒì´ê°€ í•œ ì¢Œí‘œì— ì—¬ëŸ¬ëª… ìˆì„ìˆ˜ë„ ìˆìŒ. ì²˜ë¦¬í•´ì£¼ë‹ˆ í†µê³¼í•¨.
    spies = {}
    for i in range(N):
        pos = tuple(map(int, input().split()))
        spies.setdefault(pos, []).append(i+1)

    # ë°©í–¥ê°’ ë§µí•‘
    direction = {"I": (1, 0), "S": (0, 1), "Z": (-1, 0), "J": (0, -1)}

    # (ì¶œì œìì™€ ê°™ì€ ìœ„ì¹˜ or ì¸ì ‘í•œ 8ê°œì˜ ìœ„ì¹˜)ì¼ ê²½ìš° ë„ì²­ ê°€ëŠ¥í•˜ë¯€ë¡œ, ì¶œì œì ì¢Œí‘œë„ ê³ ë ¤í•˜ê²Œë” (0, 0) ì¶”ê°€.
    dx = [0, 1, 0, -1, 0, 1, 1, -1, -1]
    dy = [0, 0, 1, 0, -1, 1, -1, 1, -1]

    K = int(input())
    # ì´ˆê¸° ìœ„ì¹˜(0, 0)ì—ì„œë¶€í„° ë„ì²­í• ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ ë§¨ ì•ì— ì¶”ê°€.
    tester = [(0, 0)] + [direction[d] for d in input().rstrip()]
    x = y = 0

    ret = set()

    for r, c in tester:
        x += r
        y += c

        for i in range(9):
            nx, ny = x + dx[i], y + dy[i]

            # ì´ë™í•œ ì¢Œí‘œ ì£¼ë³€ìœ¼ë¡œ ìŠ¤íŒŒì´ê°€ ìˆë‹¤ë©´, í•´ë‹¹ ìŠ¤íŒŒì´ì˜ ë²ˆí˜¸ ì¶”ê°€
            if (nx, ny) in spies:
                # í•´ë‹¹ ì¢Œí‘œì— ìˆëŠ” ìŠ¤íŒŒì´ê°€ ì—¬ëŸ¬ëª…ì¼ê²½ìš° ë¦¬ìŠ¤íŠ¸ í˜•íƒœì´ë¯€ë¡œ set()ë³€í™˜ í›„ í•©ì§‘í•©.
                # -> â—ì°¸ê³ ë¡œ addëŠ” ë¶ˆê°€ëŠ¥í•˜ë‹¤. setì—ëŠ” mutableí•œ ê°ì²´ëŠ” ëª» ë“¤ì–´ê°€ê¸° ë•Œë¬¸. (int, str, tuple ê°™ì€ê±´ ê°€ëŠ¥)
                ret |= set(spies[(nx, ny)])
    if ret:
        print(*sorted(ret), sep="\n")
    else:
        print(-1)


main()